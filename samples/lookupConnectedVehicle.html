<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
    <title>Connected Cars</title>
    <style>
    .container { padding-bottom: 100px; }
    .fas.fa-check { color: #00cc00; }
    .fas.fa-times { color: #cc0000; }
    </style>
  </head>
  <body class="bg-light">
    <div class="container">
      <div class="row justify-content-md-center">
        <div class="col-md-8 py-5 text-center">
          <svg style="height: 50px;" viewBox="0 0 160 40" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd" clip-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="1.4142"><title>Connected Cars</title><path d="M52.161,6.967l-1.495,1.759c-0.877,-0.903 -2.087,-1.45 -3.604,-1.426c-2.182,0 -3.748,1.64 -3.748,4.042c0,2.401 1.566,4.041 3.748,4.041c1.588,0 2.869,-0.523 3.723,-1.521l1.517,1.521c-1.138,1.498 -2.963,2.355 -5.359,2.355c-3.747,0 -6.356,-2.592 -6.356,-6.396c0,-3.829 2.609,-6.444 6.356,-6.444c2.277,0 4.055,0.737 5.218,2.069Zm3.557,4.375c0,2.448 1.589,4.113 3.866,4.113c2.253,0 3.841,-1.665 3.841,-4.113c0,-2.426 -1.588,-4.09 -3.841,-4.09c-2.277,0 -3.866,1.664 -3.866,4.09Zm10.434,-0.024c0,3.804 -2.679,6.42 -6.568,6.42c-3.914,0 -6.593,-2.616 -6.593,-6.42c0,-3.828 2.679,-6.42 6.593,-6.42c3.889,0 6.568,2.592 6.568,6.42Zm14.443,-1.545l0,7.869l-2.726,0l0,-7.108c0,-1.903 -1.139,-3.068 -3.036,-3.068c-2.086,0.024 -3.392,1.474 -3.58,3.448l0,6.728l-2.728,0l0,-12.649l2.728,0l0,2.425c0.9,-1.759 2.513,-2.52 4.647,-2.52c2.941,0 4.695,1.854 4.695,4.875Zm15.25,0l0,7.869l-2.727,0l0,-7.108c0,-1.903 -1.139,-3.068 -3.036,-3.068c-2.087,0.024 -3.391,1.474 -3.58,3.448l0,6.728l-2.728,0l0,-12.649l2.728,0l0,2.425c0.9,-1.759 2.513,-2.52 4.647,-2.52c2.941,0 4.696,1.854 4.696,4.875Zm11.905,0.593c-0.095,-2.044 -1.447,-3.281 -3.51,-3.281c-1.992,0 -3.391,1.261 -3.699,3.281l7.209,0Zm2.372,1.999l-9.534,0c0.427,1.948 1.921,3.161 3.913,3.161c1.375,0 2.633,-0.524 3.558,-1.474l1.446,1.545c-1.233,1.356 -3.036,2.141 -5.217,2.141c-3.89,0 -6.451,-2.592 -6.451,-6.397c0,-3.827 2.633,-6.419 6.379,-6.443c4.435,0 6.238,2.901 5.906,7.467Zm12.759,-5.398l-1.494,1.759c-0.878,-0.903 -2.088,-1.45 -3.605,-1.426c-2.182,0 -3.747,1.64 -3.747,4.042c0,2.401 1.565,4.041 3.747,4.041c1.588,0 2.87,-0.523 3.723,-1.521l1.517,1.521c-1.138,1.498 -2.963,2.355 -5.359,2.355c-3.747,0 -6.356,-2.592 -6.356,-6.396c0,-3.829 2.609,-6.444 6.356,-6.444c2.278,0 4.055,0.737 5.218,2.069Zm9.652,9.867c-0.996,0.595 -2.039,0.928 -3.107,0.928c-1.897,0 -3.534,-1.094 -3.534,-3.686l0,-6.562l-1.777,0l0,-2.045l1.777,0l0,-3.472l2.704,0l0,3.472l3.723,0l0,2.045l-3.723,0l0,6.063c0,1.307 0.498,1.711 1.351,1.711c0.57,0 1.163,-0.189 1.898,-0.546l0.688,2.092Zm10.625,-6.468c-0.095,-2.044 -1.447,-3.281 -3.511,-3.281c-1.992,0 -3.39,1.261 -3.698,3.281l7.209,0Zm2.371,1.999l-9.533,0c0.427,1.948 1.921,3.161 3.912,3.161c1.376,0 2.633,-0.524 3.558,-1.474l1.446,1.545c-1.232,1.356 -3.035,2.141 -5.217,2.141c-3.889,0 -6.45,-2.592 -6.45,-6.397c0,-3.827 2.632,-6.419 6.379,-6.443c4.434,0 6.237,2.901 5.905,7.467Zm11.669,-0.999c0,-2.449 -1.589,-4.161 -3.867,-4.161c-2.275,0 -3.865,1.735 -3.888,4.161c0.023,2.4 1.588,4.113 3.888,4.113c2.278,0 3.867,-1.713 3.867,-4.113Zm2.726,6.276l-2.726,0l0,-2.163c-0.902,1.474 -2.42,2.282 -4.435,2.282c-3.628,0 -6.048,-2.639 -6.048,-6.491c0,-3.804 2.443,-6.396 6,-6.396c2.04,0 3.558,0.832 4.483,2.306l0,-7.18l2.726,0l0,17.642Zm-107.763,9.139l-1.495,1.76c-0.877,-0.903 -2.087,-1.451 -3.604,-1.427c-2.182,0 -3.748,1.641 -3.748,4.042c0,2.402 1.566,4.042 3.748,4.042c1.588,0 2.869,-0.524 3.723,-1.522l1.517,1.522c-1.138,1.498 -2.963,2.354 -5.359,2.354c-3.747,0 -6.356,-2.592 -6.356,-6.396c0,-3.828 2.609,-6.443 6.356,-6.443c2.277,0 4.055,0.737 5.218,2.068Zm9.534,6.23l0,-1.166l-3.416,0c-1.778,0 -2.609,0.475 -2.609,1.689c0,1.141 0.925,1.878 2.443,1.878c1.945,0 3.439,-1.022 3.582,-2.401Zm0.023,2.901c-0.901,1.117 -2.348,1.664 -4.174,1.664c-2.728,0 -4.434,-1.689 -4.434,-3.923c0,-2.306 1.73,-3.781 4.766,-3.804l3.819,0l0,-0.381c0,-1.593 -1.02,-2.545 -3.011,-2.545c-1.21,0 -2.468,0.428 -3.725,1.285l-1.114,-1.902c1.754,-1.047 3.035,-1.593 5.431,-1.593c3.248,0 5.075,1.664 5.098,4.446l0.025,8.298l-2.681,0l0,-1.545Zm8.585,-8.584c0.854,-1.712 2.372,-2.615 4.364,-2.615l0,2.615c-2.537,-0.143 -4.15,1.355 -4.364,3.52l0,6.609l-2.727,0l0,-12.649l2.727,0l0,2.52Zm14.324,-1.355l-0.996,2.021c-1.115,-0.69 -2.514,-1.117 -3.628,-1.117c-1.067,0 -1.849,0.355 -1.849,1.26c0,2.329 6.71,1.069 6.686,5.658c0,2.592 -2.3,3.757 -4.837,3.757c-1.849,0 -3.819,-0.618 -5.076,-1.76l0.974,-1.949c1.091,0.975 2.846,1.569 4.221,1.569c1.162,0 2.062,-0.404 2.062,-1.355c0,-2.591 -6.639,-1.142 -6.615,-5.707c0,-2.567 2.229,-3.661 4.647,-3.661c1.589,0 3.273,0.476 4.411,1.284Z"></path><path style="fill: #2d7ae0;" d="M23.864,2.142c0.518,-0.745 1.381,-1.233 2.357,-1.233c1.584,0 2.87,1.286 2.87,2.87c0,1.273 -0.83,2.353 -1.978,2.729l0,3.298c1.139,0.381 1.961,1.456 1.961,2.723c0,1.584 -1.286,2.87 -2.87,2.87c-1.585,0 -2.87,-1.286 -2.87,-2.87c0,-0.099 0.005,-0.197 0.014,-0.293c-1.013,-0.395 -2.096,-0.601 -3.208,-0.601c-4.889,0 -8.858,3.97 -8.858,8.859c0,4.888 3.969,8.858 8.858,8.858c1.126,0 2.222,-0.21 3.245,-0.614c-0.034,-0.177 -0.051,-0.359 -0.051,-0.545c0,-1.585 1.285,-2.87 2.87,-2.87c1.584,0 2.87,1.285 2.87,2.87c0,1.26 -0.814,2.331 -1.944,2.717l0,3.47c1.13,0.386 1.944,1.457 1.944,2.717c0,1.585 -1.286,2.87 -2.87,2.87c-0.926,0 -1.749,-0.438 -2.274,-1.119c-1.216,0.206 -2.67,0.338 -3.811,0.338c-7.652,0 -14.416,-4.593 -17.3,-11.665c-1.561,-0.027 -2.819,-1.302 -2.819,-2.869c0,-1.585 1.286,-2.87 2.87,-2.87c1.584,0 2.87,1.285 2.87,2.87c0,0.953 -0.465,1.798 -1.181,2.32c2.637,6.312 8.7,10.396 15.56,10.396c0.951,0 2.164,-0.104 3.215,-0.265l0,-0.006c0,-1.273 0.83,-2.353 1.978,-2.728l0,-3.448c-0.382,-0.125 -0.729,-0.327 -1.021,-0.589c-0.004,0.002 -0.008,0.003 -0.012,0.005c-1.298,0.547 -2.7,0.833 -4.139,0.833c-5.893,0 -10.676,-4.783 -10.676,-10.676c0,-5.893 4.783,-10.677 10.676,-10.677c1.372,0 2.711,0.261 3.96,0.76c0.324,-0.348 0.733,-0.617 1.195,-0.771l0,-3.31c-1.096,-0.374 -1.894,-1.391 -1.942,-2.601c-1.013,-0.188 -2.115,-0.289 -3.243,-0.301c-6.578,-0.069 -12.835,4.128 -15.492,10.199c0.682,0.525 1.122,1.349 1.122,2.276c0,1.584 -1.286,2.87 -2.87,2.87c-1.584,0 -2.87,-1.286 -2.87,-2.87c0,-1.584 1.286,-2.87 2.87,-2.87c0.008,0 0.016,0 0.024,0c2.911,-6.802 9.868,-11.5 17.234,-11.423c1.295,0.013 2.565,0.135 3.736,0.366Zm2.34,33.903c-0.581,0 -1.052,0.472 -1.052,1.052c0,0.58 0.471,1.052 1.052,1.052c0.58,0 1.051,-0.472 1.051,-1.052c0,-0.58 -0.471,-1.052 -1.051,-1.052Zm0,-8.904c-0.581,0 -1.052,0.472 -1.052,1.052c0,0.58 0.471,1.052 1.052,1.052c0.58,0 1.051,-0.472 1.051,-1.052c0,-0.58 -0.471,-1.052 -1.051,-1.052Zm-23.334,-3.541c-0.58,0 -1.052,0.472 -1.052,1.052c0,0.58 0.472,1.052 1.052,1.052c0.58,0 1.052,-0.472 1.052,-1.052c0,-0.58 -0.472,-1.052 -1.052,-1.052Zm0,-8.583c-0.58,0 -1.052,0.472 -1.052,1.052c0,0.58 0.472,1.052 1.052,1.052c0.58,0 1.052,-0.472 1.052,-1.052c0,-0.58 -0.472,-1.052 -1.052,-1.052Zm23.334,-3.54c-0.581,0 -1.052,0.472 -1.052,1.052c0,0.58 0.471,1.052 1.052,1.052c0.58,0 1.051,-0.472 1.051,-1.052c0,-0.58 -0.471,-1.052 -1.051,-1.052Zm0.017,-8.75c-0.58,0 -1.052,0.472 -1.052,1.052c0,0.58 0.472,1.052 1.052,1.052c0.58,0 1.052,-0.472 1.052,-1.052c0,-0.58 -0.472,-1.052 -1.052,-1.052Z"></path></svg>
          <p class="mt-4">Indtast nummerplade eller stelnummer for at få information om bilens status hos Connected Cars.</p>
        </div>
      </div>

      <div class="row justify-content-md-center">
        <div class="col-md-4">
          <div id="alert" class="alert alert-danger" role="alert" style="display: none;"></div>
          <form>
            <div class="mb-4">
              <label for="query">Nummerplade eller stelnummer</label>
              <input type="text" class="form-control" id="query" placeholder="Indtast nummerplade eller stelnummer..." required>
            </div>
            <button class="btn btn-primary btn-lg btn-block" type="submit">Hent oplysninger</button>
          </form>
        </div>
      </div>

      <div class="row justify-content-md-center">
        <div class="col-md-8">
          <hr class="mt-4 mb-4">
        </div>
      </div>

      <div id="result" class="row justify-content-md-center" style="display: none;">
        <div class="col-md-4">
          <h4 id="vin"></h4>
          <ul class="list-group">
            <li id="supported" class="list-group-item d-flex justify-content-between align-items-center">
              Understøttet
              <i class="fas"></i>
            </li>
            <li id="connected" class="list-group-item d-flex justify-content-between align-items-center">
              Forbundet
              <i class="fas"></i>
            </li>
          </ul>
        </div>
      </div>
      <div id="spinner" class="row justify-content-md-center" style="display: none;">
        <div class="col-md-4 text-center">
          <i class="fas fa-spinner fa-spin fa-4x"></i>
        </div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
    <script>
      $(document).ready(function () {
        $('html').scrollTop(0);
        $('form').submit(function (e) {
          e.preventDefault();
          $('#alert').hide();
          $('#result').hide();
          $('#spinner').show();
          var query = $('input').val();
          $.ajax({
            type: 'POST',
            url: 'https://api.connectedcars.io/graphql', 
            data: JSON.stringify({
              operationName: 'LookupConnectedVehicle',
              query: 'query LookupConnectedVehicle($query: String!) { lookupConnectedVehicle(country: dk, query: $query) { vin, supported, connected } }',
              variables: { query: query }
            }),
            contentType: 'application/json'
          }).done(function(data) {
            if (data.errors) {
              if (data.errors[0].type === 'input-invalid') {
                $('#alert').text('Indtastningen er ikke gyldig!');
              } else {
                $('#alert').text('Noget gik galt, prøv igen.');
              }
              $('#spinner').hide();
              $('#alert').show();
              return;
            }
            var vin = null;
            var supported = null;
            var connected = null;
            if (data.data.lookupConnectedVehicle) {
              var result = data.data.lookupConnectedVehicle;
              vin = result.vin;
              supported = result.supported;
              connected = result.connected;
            }
            $('#vin').text(vin ? vin : 'Ikke fundet');
            $('#supported > i, #connected > i, #activated > i').removeClass('fa-check fa-question fa-times');
            switch (supported) {
              case true:
                $('#supported > i').addClass('fa-check');
                break;
              case false:
                $('#supported > i').addClass('fa-times');
                break;
              default:
                $('#supported > i').addClass('fa-question');
                break;
            }
            switch (connected) {
              case true:
                $('#connected > i').addClass('fa-check');
                break;
              case false:
                $('#connected > i').addClass('fa-times');
                break;
              default:
                $('#connected > i').addClass('fa-question');
                break;
            }
            $('#result').show();
            $('#spinner').hide();
            $('html').scrollTop(500);
          }).fail(function() {
            $('#alert').text('Noget gik galt, prøv igen.');
            $('#spinner').hide();
            $('#alert').show();
            return;
          });
        });
      })
    </script>
  </body>
</html>
